<mujoco model="xgourdf">
  <!-- 1. 添加default配置，区分motor、visual、collision类（与Lite3保持一致） -->
  <default>
    <default class="robot">
      <default class="motor">
        <joint type="hinge" /> <!-- 显式声明关节类型为铰链 -->
        <motor />
      </default>
      <default class="visual">
        <geom material="visualgeom" contype="0" conaffinity="0" group="2" /> <!-- 视觉几何：无碰撞，分组2 -->
      </default>
      <default class="collision">
        <geom material="collision_material" condim="3" contype="0" conaffinity="1" group="1" solref="0.005 1" friction="1 0.01 0.01" /> <!-- 碰撞几何：有碰撞，分组1 -->
        <equality solimp="0.99 0.999 1e-05" solref="0.005 1" />
      </default>
    </default>
  </default>

  <!-- 2. 补充compiler的autolimits属性（与Lite3保持一致） -->
  <compiler angle="radian" />
  <compiler autolimits="true"/>

  <!-- 3. 完善asset：添加材质、纹理（保留原有mesh路径） -->
  <asset>
    <!-- 基础材质（与Lite3一致） -->
    <material name="default_material" rgba="0.7 0.7 0.7 1" />
    <material name="collision_material" rgba="0.0 0.4 0.8 0.2" /> <!-- 碰撞几何半透明蓝色 -->
    <material name="visualgeom" rgba="0.8902 0.8902 0.91373 1" /> <!-- 视觉几何使用原有颜色 -->
    <!-- 地板纹理（与Lite3一致） -->
    <texture type="2d" name="checker" builtin="checker" rgb1="0.2 0.3 0.4" rgb2="0.9 0.9 0.9" width="500" height="500"/>
    <material name="checker_mat" texture="checker" specular="1" shininess="1" texrepeat="15 15"/>
    
    <!-- 原有mesh路径（保留不变） -->
    <mesh name="body" file="../meshes/body.STL"/>
    <mesh name="bl_hip" file="../meshes/bl_hip.STL"/>
    <mesh name="bl_thigh" file="../meshes/bl_thigh.STL"/>
    <mesh name="bl_calf" file="../meshes/bl_calf.STL"/>
    <mesh name="bl_foot" file="../meshes/bl_foot.STL"/>
    <mesh name="br_hip" file="../meshes/br_hip.STL"/>
    <mesh name="br_thigh" file="../meshes/br_thigh.STL"/>
    <mesh name="br_calf" file="../meshes/br_calf.STL"/>
    <mesh name="br_foot" file="../meshes/br_foot.STL"/>
    <mesh name="fl_hip" file="../meshes/fl_hip.STL"/>
    <mesh name="fl_thigh" file="../meshes/fl_thigh.STL"/>
    <mesh name="fl_calf" file="../meshes/fl_calf.STL"/>
    <mesh name="fl_foot" file="../meshes/fl_foot.STL"/>
    <mesh name="fr_hip" file="../meshes/fr_hip.STL"/>
    <mesh name="fr_thigh" file="../meshes/fr_thigh.STL"/>
    <mesh name="fr_calf" file="../meshes/fr_calf.STL"/>
    <mesh name="fr_foot" file="../meshes/fr_foot.STL"/>
  </asset>

  <!-- 4. 重构worldbody：添加地板、灯光、根body（浮动基）、相机、缺失的site -->
  <worldbody>
    <!-- 地板（与Lite3一致） -->
    <geom name="floor" type="plane" size="10 10 0.1" pos="0 0 0" material="checker_mat"/>
    <!-- 环境光（与Lite3一致） -->
    <light directional="true" pos="-0.5 0.5 3" dir="0 0 -1"/>

    <!-- 根body：包裹整个机器人，添加浮动关节、IMU站点、body站点、相机（对应sensor的引用） -->
    <body name="BODY" pos="0 0 0.1" quat="1 0 0 0" childclass="robot">
      <!-- 浮动关节：机器人的自由基（与Lite3的floating_base一致） -->
      <freejoint name="floating_base" />
      <!-- IMU站点：修复sensor中imu_site的引用缺失 -->
      <site name="imu_site" pos="0 0 0" size="0.005" rgba="1 0 0 1"/>
      <!-- Body站点：修复sensor中body_site的引用缺失 -->
      <site name="body_site" pos="0 0 0" size="0.005" rgba="0 1 0 1"/>
      <!-- 根body的惯性参数（可根据实际需求调整，这里给默认值） -->
      <!-- <inertial pos="0 0 0" mass="0.5" diaginertia="0.001 0.001 0.001"/> -->
      <inertial pos="0 0 0" mass="0.18845" diaginertia="7.6287e-05 0.00052346 0.00055683"/>
      <!-- 机器人主体：拆分为碰撞几何和视觉几何（与Lite3的TORSO一致） -->
      <geom name="body_collision" pos="0 0 0" quat="1 0 0 0" type="mesh" mesh="body" class="collision" />
      <geom name="body_visual" pos="0 0 0" quat="1 0 0 0" type="mesh" mesh="body" class="visual" />



      <!-- 左后腿（保留原有参数，geom拆分为碰撞和视觉，FOOT改为BODY节点） -->
      <body name="bl_hip" pos="-0.067842 0.02085 0">
        <!-- <inertial pos="0.00200326 0.025876 0.00551368" quat="0.417008 0.557126 -0.57552 0.429525" mass="0.0105904" diaginertia="4.59417e-06 4.13298e-06 1.28639e-06"/> -->
        <inertial pos="0.002003 0.025876 0.005514" mass="0.0105904" diaginertia="4.133e-06 1.552e-06 4.328e-06"/>
        <joint name="bl_hip_joint" type="hinge" pos="0 0 0" axis="1 0 0" range="-0.3 0.3" actuatorfrcrange="-0.45 0.45" class="motor"/>
        <geom name="bl_hip_collision" type="mesh" mesh="bl_hip" class="collision"/>
        <geom name="bl_hip_visual" type="mesh" mesh="bl_hip" class="visual"/>
        <body name="bl_thigh" pos="0 0.036855 0">
          <!-- <inertial pos="-5.9763e-05 -0.0020681 -0.028882" quat="0.993498 -0.113681 0.00125127 0.00607789" mass="0.045114" diaginertia="1.7197e-05 1.71363e-05 3.53005e-06"/> -->
          <inertial pos="-5.9763e-05 -0.0020681 -0.028882" mass="0.045114" diaginertia="1.7197e-05 1.6442e-05 4.2244e-06"/>
          <joint name="bl_thigh_joint" type="hinge" pos="0 0 0" axis="0 1 0" range="-1 2" actuatorfrcrange="-0.45 0.45" class="motor"/>
          <geom name="bl_thigh_collision" type="mesh" mesh="bl_thigh" class="collision"/>
          <geom name="bl_thigh_visual" type="mesh" mesh="bl_thigh" class="visual"/>
          <body name="bl_calf" pos="0 0 -0.059063">
            <!-- <inertial pos="0.000460441 0.00954138 -0.0317547" quat="0.950977 -0.308173 -0.0252055 -0.00605965" mass="0.0128105101695308" diaginertia="1.53886e-05 1.20256e-05 4.09463e-06"/> -->
            <inertial pos="0.000728 0.002071 -0.035626" mass="0.0128105101695308" diaginertia="7.467e-06 7.596e-06 5.956e-07"/>
            <joint name="bl_calf_joint" type="hinge" pos="0 0 0" axis="0 1 0" range="-2.69 -0.5" actuatorfrcrange="-0.45 0.45" class="motor"/>
            <geom name="bl_calf_collision" type="mesh" mesh="bl_calf" class="collision"/>
            <geom name="bl_calf_visual" type="mesh" mesh="bl_calf" class="visual"/>
            <!-- 关键修改：将bl_foot从geom改为body节点 -->
            <body name="bl_foot" pos="0 0 -0.065864" quat="1 0 0 0">
              <inertial pos="0 0 0" mass="0.00167992580343433" diaginertia="1e-08 1e-08 1e-08"/>
              <!-- <inertial pos="-0.002152 0.000643 -0.002230" mass="0.00167992580343433" diaginertia="7.540e-08 3.805e-08 7.736e-08"/> -->
              <geom name="bl_foot_collision" type="mesh" mesh="bl_foot" class="collision"/>
              <geom name="bl_foot_visual" type="mesh" mesh="bl_foot" class="visual"/>
            </body>
          </body>
        </body>
      </body>

      <!-- 右后腿（保留原有参数，geom拆分为碰撞和视觉，FOOT改为BODY节点） -->
      <body name="br_hip" pos="-0.05616 -0.02085 0">
        <!-- <inertial pos="-0.00967871 -0.025876 0.00551365" quat="0.557124 0.417006 -0.429526 0.575522" mass="0.0105904" diaginertia="4.59417e-06 4.13299e-06 1.28639e-06"/> -->
        <inertial pos="-0.009679 -0.025876 0.005514" mass="0.01059" diaginertia="4.133e-06 1.552e-06 4.328e-06"/>
        <joint name="br_hip_joint" type="hinge" pos="0 0 0" axis="1 0 0" range="-0.3 0.3" actuatorfrcrange="-0.45 0.45" class="motor"/>
        <geom name="br_hip_collision" type="mesh" mesh="br_hip" class="collision"/>
        <geom name="br_hip_visual" type="mesh" mesh="br_hip" class="visual"/>
        <body name="br_thigh" pos="-0.011685 -0.03686 0">
          <!-- <inertial pos="-5.894e-05 0.0020738 -0.028881" quat="0.993505 0.113762 0.000832863 -0.00225745" mass="0.045112" diaginertia="1.7194e-05 1.71342e-05 3.52919e-06"/> -->
          <inertial pos="-5.894e-05 0.0020738 -0.028881" mass="0.045112" diaginertia="1.7194e-05 1.6439e-05 4.2244e-06"/>
          <joint name="br_thigh_joint" type="hinge" pos="0 0 0" axis="0 1 0" range="-1 2" actuatorfrcrange="-0.45 0.45" class="motor"/>
          <geom name="br_thigh_collision" type="mesh" mesh="br_thigh" class="collision"/>
          <geom name="br_thigh_visual" type="mesh" mesh="br_thigh" class="visual"/>
          <body name="br_calf" pos="0 0 -0.059063">
            <!-- <inertial pos="0.000327322 0.00573518 -0.0317487" quat="0.951827 -0.305218 -0.0285668 0.00723503" mass="0.0128088078540617" diaginertia="1.59596e-05 1.12904e-05 5.3962e-06"/> -->
            <inertial pos="0.000728 -0.002067 -0.035621" mass="0.0128088078540617" diaginertia="7.466e-06 7.596e-06 5.952e-07"/>
            <joint name="br_calf_joint" type="hinge" pos="0 0 0" axis="0 1 0" range="-2.69 -0.5" actuatorfrcrange="-0.45 0.45" class="motor"/>
            <geom name="br_calf_collision" type="mesh" mesh="br_calf" class="collision"/>
            <geom name="br_calf_visual" type="mesh" mesh="br_calf" class="visual"/>
            <!-- 关键修改：将br_foot从geom改为body节点 -->
            <body name="br_foot" pos="0 0 -0.065864" quat="1 0 0 0">
              <inertial pos="0 0 0" mass="0.00167996390771006" diaginertia="1e-08 1e-08 1e-08"/>
              <!-- <inertial pos="-0.002152 -0.000638 -0.002230" mass="0.00167996390771006" diaginertia="7.540e-08 3.805e-08 7.736e-08"/> -->
              <geom name="br_foot_collision" type="mesh" mesh="br_foot" class="collision"/>
              <geom name="br_foot_visual" type="mesh" mesh="br_foot" class="visual"/>
            </body>
          </body>
        </body>
      </body>

      <!-- 左前腿（保留原有参数，geom拆分为碰撞和视觉，FOOT改为BODY节点） -->
      <body name="fl_hip" pos="0.062526 0.020224 0">
        <!-- <inertial pos="0.00232573 0.025876 0.00551368" quat="0.417008 0.557126 -0.57552 0.429525" mass="0.0105904" diaginertia="4.59417e-06 4.13298e-06 1.28639e-06"/> -->
        <inertial pos="0.00232573 0.025876 0.00551368" mass="0.0105904" diaginertia="4.1334e-06 1.5517e-06 4.3284e-06"/>
        <joint name="fl_hip_joint" type="hinge" pos="0 0 0" axis="1 0 0" range="-0.3 0.3" actuatorfrcrange="-0.45 0.45" class="motor"/>
        <geom name="fl_hip_collision" type="mesh" mesh="fl_hip" class="collision"/>
        <geom name="fl_hip_visual" type="mesh" mesh="fl_hip" class="visual"/>
        <body name="fl_thigh" pos="0.00031911 0.037482 0">
          <!-- <inertial pos="-5.9763e-05 -0.0026948 -0.028882" quat="0.993498 -0.113681 0.00125127 0.00607789" mass="0.045114" diaginertia="1.7197e-05 1.71363e-05 3.53005e-06"/> -->
          <inertial pos="-5.9763e-05 -0.0026948 -0.028882" mass="0.045114" diaginertia="1.7197e-05 1.6442e-05 4.2244e-06"/>
          <joint name="fl_thigh_joint" type="hinge" pos="0 0 0" axis="0 1 0" range="-1 2" actuatorfrcrange="-0.45 0.45" class="motor"/>
          <geom name="fl_thigh_collision" type="mesh" mesh="fl_thigh" class="collision"/>
          <geom name="fl_thigh_visual" type="mesh" mesh="fl_thigh" class="visual"/>
          <body name="fl_calf" pos="-1.4535e-05 0 -0.059049">
            <!-- <inertial pos="0.000292381 0.00891927 -0.0317942" quat="0.950904 -0.308591 -0.0232749 -0.00341969" mass="0.0128105159723828" diaginertia="1.53755e-05 1.19997e-05 4.10784e-06"/> -->
            <inertial pos="0.000566 0.001446 -0.035644" mass="0.0128105159723828" diaginertia="7.470e-06 7.596e-06 5.925e-07"/>
            <joint name="fl_calf_joint" type="hinge" pos="0 0 0" axis="0 1 0" range="-2.69 -0.5" actuatorfrcrange="-0.45 0.45" class="motor"/>
            <geom name="fl_calf_collision" type="mesh" mesh="fl_calf" class="collision"/>
            <geom name="fl_calf_visual" type="mesh" mesh="fl_calf" class="visual"/>
            <!-- 关键修改：将fl_foot从geom改为body节点 -->
            <body name="fl_foot" pos="-0.00030458 0 -0.065887" quat="1 0 0 0">
              <inertial pos="0 0 0" mass="0.00167992580204063" diaginertia="1e-08 1e-08 1e-08"/> 给foot添加微小惯性（避免MuJoCo警告）
              <!-- <inertial pos="-0.002162 0.000019 -0.002212" mass="0.00167992580204063" diaginertia="7.553e-08 3.805e-08 7.723e-08"/> -->
              <geom name="fl_foot_collision" type="mesh" mesh="fl_foot" class="collision"/>
              <geom name="fl_foot_visual" type="mesh" mesh="fl_foot" class="visual"/>
            </body>
          </body>
        </body>
      </body>

      <!-- 右前腿（保留原有参数，geom拆分为碰撞和视觉，FOOT改为BODY节点） -->
      <body name="fr_hip" pos="0.062526 -0.02085 0">
        <!-- <inertial pos="0.0023257 -0.025249 0.0055137" quat="0.557125 0.417005 -0.429525 0.575523" mass="0.01059" diaginertia="4.59415e-06 4.13295e-06 1.2864e-06"/> -->
        <inertial pos="0.0023257 -0.025249 0.0055137" mass="0.01059" diaginertia="4.1334e-06 1.5517e-06 4.3284e-06"/>
        <joint name="fr_hip_joint" type="hinge" pos="0 0 0" axis="1 0 0" range="-0.3 0.3" actuatorfrcrange="-0.45 0.45" class="motor"/>
        <geom name="fr_hip_collision" type="mesh" mesh="fr_hip" class="collision"/>
        <geom name="fr_hip_visual" type="mesh" mesh="fr_hip" class="visual"/>
        <body name="fr_thigh" pos="0.00031911 -0.03686 0">
          <!-- <inertial pos="-5.894e-05 0.0027005 -0.028881" quat="0.993505 0.113762 0.000832863 -0.00225745" mass="0.045112" diaginertia="1.7194e-05 1.71342e-05 3.52919e-06"/> -->
          <inertial pos="-5.894e-05 0.0027005 -0.028881" mass="0.045112" diaginertia="1.7194e-05 1.6439e-05 4.2244e-06"/>
          <joint name="fr_thigh_joint" type="hinge" pos="0 0 0" axis="0 1 0" range="-1 2" actuatorfrcrange="-0.45 0.45" class="motor"/>
          <geom name="fr_thigh_collision" type="mesh" mesh="fr_thigh" class="collision"/>
          <geom name="fr_thigh_visual" type="mesh" mesh="fr_thigh" class="visual"/>
          <body name="fr_calf" pos="-1.4535e-05 0 -0.059049">
            <!-- <inertial pos="0.000148057 0.00636183 -0.0317637" quat="0.951778 -0.305421 -0.0270821 0.010131" mass="0.012809" diaginertia="1.59671e-05 1.12974e-05 5.396e-06"/> -->
            <inertial pos="0.000566 -0.001442 -0.035639" mass="0.012809" diaginertia="7.470e-06 7.596e-06 5.921e-07"/>
            <joint name="fr_calf_joint" type="hinge" pos="0 0 0" axis="0 1 0" range="-2.69 -0.5" actuatorfrcrange="-0.45 0.45" class="motor"/>
            <geom name="fr_calf_collision" type="mesh" mesh="fr_calf" class="collision"/>
            <geom name="fr_calf_visual" type="mesh" mesh="fr_calf" class="visual"/>
            <!-- 关键修改：将fr_foot从geom改为body节点 -->
            <body name="fr_foot" pos="0 0 -0.065878" quat="1 0 0 0">
              <inertial pos="0 0 0" mass="0.00168" diaginertia="1e-08 1e-08 1e-08"/>
              <!-- <inertial pos="-0.002467 -0.000014 -0.002220" mass="0.00168" diaginertia="7.553e-08 3.806e-08 7.723e-08"/> -->
              <geom name="fr_foot_collision" type="mesh" mesh="fr_foot" class="collision"/>
              <geom name="fr_foot_visual" type="mesh" mesh="fr_foot" class="visual"/>
            </body>
          </body>
        </body>
      </body>


      <!-- 相机（与Lite3一致，用于可视化） -->
      <camera name="front_camera" mode="track" fovy="90.0" quat="4.329780281177467e-17 4.329780281177466e-17 0.7071067811865475 0.7071067811865476" pos="0.0 2.0 0.5" />
      <camera name="side_camera" mode="track" fovy="90.0" quat="-0.5 -0.4999999999999999 0.5 0.5000000000000001" pos="-2.0 0.0 0.5" />
    </body>
  </worldbody>

  <!-- 5. 修复actuator：修正fl_calf_joint_ctrl的错误引用 -->
  <actuator>
    <motor name="bl_hip_joint_ctrl" joint="bl_hip_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="bl_thigh_joint_ctrl" joint="bl_thigh_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="bl_calf_joint_ctrl" joint="bl_calf_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="br_hip_joint_ctrl" joint="br_hip_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="br_thigh_joint_ctrl" joint="br_thigh_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="br_calf_joint_ctrl" joint="br_calf_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="fl_hip_joint_ctrl" joint="fl_hip_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="fl_thigh_joint_ctrl" joint="fl_thigh_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="fl_calf_joint_ctrl" joint="fl_calf_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/> <!-- 修复：原指向FL_Knee_joint -->
    <motor name="fr_hip_joint_ctrl" joint="fr_hip_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="fr_thigh_joint_ctrl" joint="fr_thigh_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
    <motor name="fr_calf_joint_ctrl" joint="fr_calf_joint" class="motor" gear="1" ctrlrange="-0.45 0.45"/>
  </actuator>

  <!-- 6. 调整contact：body1改为根body名称BODY（与重构后的结构一致），现在foot是body，引用有效 -->
  <contact>
    <exclude body1="BODY" body2="bl_hip" />
    <exclude body1="bl_hip" body2="bl_thigh" />
    <exclude body1="bl_thigh" body2="bl_calf" />
    <exclude body1="bl_calf" body2="bl_foot" />
    <exclude body1="BODY" body2="br_hip" />
    <exclude body1="br_hip" body2="br_thigh" />
    <exclude body1="br_thigh" body2="br_calf" />
    <exclude body1="br_calf" body2="br_foot" />
    <exclude body1="BODY" body2="fl_hip" />
    <exclude body1="fl_hip" body2="fl_thigh" />
    <exclude body1="fl_thigh" body2="fl_calf" />
    <exclude body1="fl_calf" body2="fl_foot" />
    <exclude body1="BODY" body2="fr_hip" />
    <exclude body1="fr_hip" body2="fr_thigh" />
    <exclude body1="fr_thigh" body2="fr_calf" />
    <exclude body1="fr_calf" body2="fr_foot" />
  </contact>

  <!-- 7. 保留sensor：已修复site引用，无需修改 -->
  <sensor>
    <framepos name="body_site_pos" objtype="site" objname="body_site" />
    <framequat name="body_site_quat" objtype="site" objname="body_site" />
    <framelinvel name="body_site_linvel" objtype="site" objname="body_site" />
    <frameangvel name="body_site_angvel" objtype="site" objname="body_site" />
    <velocimeter name="body_site_vel" site="body_site" />
    <accelerometer site="imu_site"/>
    <gyro          site="imu_site"/>
  </sensor>
</mujoco>